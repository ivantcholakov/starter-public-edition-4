{"version":3,"file":"turbolinks.js","sources":["../src/location.ts","../src/util.ts","../src/http_request.ts","../src/progress_bar.ts","../src/browser_adapter.ts","../src/history.ts","../src/scroll_manager.ts","../src/snapshot_cache.ts","../src/types.ts","../src/renderer.ts","../src/error_renderer.ts","../src/head_details.ts","../src/snapshot.ts","../src/snapshot_renderer.ts","../src/view.ts","../src/visit.ts","../src/controller.ts","../src/namespace.ts","../src/script_warning.ts","../src/index.ts"],"sourcesContent":["export type Locatable = Location | string\n\nexport class Location {\n  static get currentLocation() {\n    return this.wrap(window.location.toString())\n  }\n\n  static wrap(locatable: Locatable): Location\n  static wrap(locatable?: Locatable | null): Location | undefined\n  static wrap(locatable: Locatable) {\n    if (typeof locatable == \"string\") {\n      return new this(locatable)\n    } else if (locatable != null) {\n      return locatable\n    }\n  }\n\n  readonly absoluteURL: string\n  readonly requestURL: string\n  readonly anchor?: string\n\n  constructor(url: string) {\n    const linkWithAnchor = document.createElement(\"a\")\n    linkWithAnchor.href = url\n\n    this.absoluteURL = linkWithAnchor.href\n\n    const anchorLength = linkWithAnchor.hash.length\n    if (anchorLength < 2) {\n      this.requestURL = this.absoluteURL\n    } else {\n      this.requestURL = this.absoluteURL.slice(0, -anchorLength)\n      this.anchor = linkWithAnchor.hash.slice(1)\n    }\n  }\n\n  getOrigin() {\n    return this.absoluteURL.split(\"/\", 3).join(\"/\")\n  }\n\n  getPath() {\n    return (this.requestURL.match(/\\/\\/[^/]*(\\/[^?;]*)/) || [])[1] || \"/\"\n  }\n\n  getPathComponents() {\n    return this.getPath().split(\"/\").slice(1)\n  }\n\n  getLastPathComponent() {\n    return this.getPathComponents().slice(-1)[0]\n  }\n\n  getExtension() {\n    return (this.getLastPathComponent().match(/\\.[^.]*$/) || [])[0] || \"\"\n  }\n\n  isHTML() {\n    return this.getExtension().match(/^(?:|\\.(?:htm|html|xhtml))$/)\n  }\n\n  isPrefixedBy(location: Location): boolean {\n    const prefixURL = getPrefixURL(location)\n    return this.isEqualTo(location) || stringStartsWith(this.absoluteURL, prefixURL)\n  }\n\n  isEqualTo(location?: Location) {\n    return location && this.absoluteURL === location.absoluteURL\n  }\n\n  toCacheKey() {\n    return this.requestURL\n  }\n\n  toJSON() {\n    return this.absoluteURL\n  }\n\n  toString() {\n    return this.absoluteURL\n  }\n\n  valueOf() {\n    return this.absoluteURL\n  }\n}\n\nfunction getPrefixURL(location: Location) {\n  return addTrailingSlash(location.getOrigin() + location.getPath())\n}\n\nfunction addTrailingSlash(url: string) {\n  return stringEndsWith(url, \"/\") ? url : url + \"/\"\n}\n\nfunction stringStartsWith(string: string, prefix: string) {\n  return string.slice(0, prefix.length) === prefix\n}\n\nfunction stringEndsWith(string: string, suffix: string) {\n  return string.slice(-suffix.length) === suffix\n}\n","export function array<T>(values: ArrayLike<T>): T[] {\n  return Array.prototype.slice.call(values)\n}\n\nexport const closest = (() => {\n  const html = document.documentElement\n\n  type MatchesSelector = (this: Element, selector: string) => boolean\n  const match: MatchesSelector = html.matches\n    || (html as any).webkitMatchesSelector\n    || (html as any).msMatchesSelector\n    || (html as any).mozMatchesSelector\n\n  type Closest = (this: Element, selector: string) => Element | null\n  const closest: Closest = html.closest || function(selector: string) {\n    let element: Element | null = this\n    while (element) {\n      if (match.call(element, selector)) {\n        return element\n      } else {\n        element = element.parentElement\n      }\n    }\n  }\n\n  return function(element: Element, selector: string) {\n    return closest.call(element, selector)\n  }\n})()\n\nexport function defer(callback: () => any) {\n  setTimeout(callback, 1)\n}\n\nexport type DispatchOptions = { target: EventTarget, cancelable: boolean, data: any }\n\nexport function dispatch(eventName: string, { target, cancelable, data }: Partial<DispatchOptions> = {}) {\n  const event = document.createEvent(\"Events\") as Event & { data: any }\n  event.initEvent(eventName, true, cancelable == true)\n  event.data = data || {}\n\n  // Fix setting `defaultPrevented` when `preventDefault()` is called\n  // http://stackoverflow.com/questions/23349191/event-preventdefault-is-not-working-in-ie-11-for-custom-events\n  if (event.cancelable && !preventDefaultSupported) {\n    const { preventDefault } = event\n    event.preventDefault = function() {\n      if (!this.defaultPrevented) {\n        Object.defineProperty(this, \"defaultPrevented\", { get: () => true })\n      }\n      preventDefault.call(this)\n    }\n  }\n\n  (target || document).dispatchEvent(event)\n  return event\n}\n\nconst preventDefaultSupported = (() => {\n  const event = document.createEvent(\"Events\")\n  event.initEvent(\"test\", true, true)\n  event.preventDefault()\n  return event.defaultPrevented\n})()\n\nexport function unindent(strings: TemplateStringsArray, ...values: any[]): string {\n  const lines = trimLeft(interpolate(strings, values)).split(\"\\n\")\n  const match = lines[0].match(/^\\s+/)\n  const indent = match ? match[0].length : 0\n  return lines.map(line => line.slice(indent)).join(\"\\n\")\n}\n\nfunction trimLeft(string: string) {\n  return string.replace(/^\\n/, \"\")\n}\n\nfunction interpolate(strings: TemplateStringsArray, values: any[]) {\n  return strings.reduce((result, string, i) => {\n    const value = values[i] == undefined ? \"\" : values[i]\n    return result + string + value\n  }, \"\")\n}\n\nexport function uuid() {\n  return Array.apply(null, { length: 36 } as any).map((_, i) => {\n    if (i == 8 || i == 13 || i == 18 || i == 23) {\n      return \"-\"\n    } else if (i == 14) {\n      return \"4\"\n    } else if (i == 19) {\n      return (Math.floor(Math.random() * 4) + 8).toString(16)\n    } else {\n      return Math.floor(Math.random() * 15).toString(16)\n    }\n  }).join(\"\")\n}\n","import { Location } from \"./location\"\nimport { dispatch } from \"./util\"\n\nexport type StatusCode = number\n\nexport enum SystemStatusCode {\n  networkFailure = 0,\n  timeoutFailure = -1,\n  contentTypeMismatch = -2\n}\n\nexport interface HttpRequestDelegate {\n  requestStarted(): void\n  requestProgressed(progress: number): void\n  requestFinished(): void\n  requestCompletedWithResponse(response: string, redirectedToLocation?: Location): void\n  requestFailedWithStatusCode(statusCode: StatusCode, response?: string): void\n}\n\nexport class HttpRequest {\n  static timeout = 60\n\n  readonly delegate: HttpRequestDelegate\n  readonly location: Location\n  readonly referrer?: Location\n  readonly url: string\n\n  failed = false\n  progress = 0\n  sent = false\n  xhr?: XMLHttpRequest\n\n  constructor(delegate: HttpRequestDelegate, location: Location, referrer?: Location) {\n    this.delegate = delegate\n    this.location = location\n    this.referrer = referrer\n    this.location = Location.wrap(location)\n    this.referrer = Location.wrap(referrer)\n    this.url = location.absoluteURL\n    this.createXHR()\n  }\n\n  send() {\n    if (this.xhr && !this.sent) {\n      this.notifyApplicationBeforeRequestStart()\n      this.setProgress(0)\n      this.xhr.send()\n      this.sent = true\n      this.delegate.requestStarted()\n    }\n  }\n\n  cancel() {\n    if (this.xhr && this.sent) {\n      this.xhr.abort()\n    }\n  }\n\n  // XMLHttpRequest events\n\n  requestProgressed = (event: ProgressEvent) => {\n    if (event.lengthComputable) {\n      this.setProgress(event.loaded / event.total)\n    }\n  }\n\n  requestLoaded = () => {\n    this.endRequest(xhr => {\n      const contentType = xhr.getResponseHeader(\"Content-Type\")\n      if (contentTypeIsHTML(contentType)) {\n        if (xhr.status >= 200 && xhr.status < 300) {\n          const redirectedToLocation = Location.wrap(xhr.getResponseHeader(\"Turbolinks-Location\"))\n          this.delegate.requestCompletedWithResponse(xhr.responseText, redirectedToLocation)\n        } else {\n          this.failed = true\n          this.delegate.requestFailedWithStatusCode(xhr.status, xhr.responseText)\n        }\n      } else {\n        this.failed = true\n        this.delegate.requestFailedWithStatusCode(SystemStatusCode.contentTypeMismatch)\n      }\n    })\n  }\n\n  requestFailed = () => {\n    this.endRequest(() => {\n      this.failed = true\n      this.delegate.requestFailedWithStatusCode(SystemStatusCode.networkFailure)\n    })\n  }\n\n  requestTimedOut = () => {\n    this.endRequest(() => {\n      this.failed = true\n      this.delegate.requestFailedWithStatusCode(SystemStatusCode.timeoutFailure)\n    })\n  }\n\n  requestCanceled = () => {\n    this.endRequest()\n  }\n\n  // Application events\n\n  notifyApplicationBeforeRequestStart() {\n    dispatch(\"turbolinks:request-start\", { data: { url: this.url, xhr: this.xhr } })\n  }\n\n  notifyApplicationAfterRequestEnd() {\n    dispatch(\"turbolinks:request-end\", { data: { url: this.url, xhr: this.xhr } })\n  }\n\n  // Private\n\n  createXHR() {\n    const xhr = this.xhr = new XMLHttpRequest\n    const referrer = this.referrer ? this.referrer.absoluteURL : \"\"\n    const timeout = HttpRequest.timeout * 1000\n\n    xhr.open(\"GET\", this.url, true)\n    xhr.timeout = timeout\n    xhr.setRequestHeader(\"Accept\", \"text/html, application/xhtml+xml\")\n    xhr.setRequestHeader(\"Turbolinks-Referrer\", referrer)\n    xhr.onprogress = this.requestProgressed\n    xhr.onload = this.requestLoaded\n    xhr.onerror = this.requestFailed\n    xhr.ontimeout = this.requestTimedOut\n    xhr.onabort = this.requestCanceled\n  }\n\n  endRequest(callback: (xhr: XMLHttpRequest) => void = () => {}) {\n    if (this.xhr) {\n      this.notifyApplicationAfterRequestEnd()\n      callback(this.xhr)\n      this.destroy()\n    }\n  }\n\n  setProgress(progress: number) {\n    this.progress = progress\n    this.delegate.requestProgressed(progress)\n  }\n\n  destroy() {\n    this.setProgress(1)\n    this.delegate.requestFinished()\n  }\n}\n\nfunction contentTypeIsHTML(contentType: string | null) {\n  return (contentType || \"\").match(/^text\\/html|^application\\/xhtml\\+xml/)\n}\n","import { unindent } from \"./util\"\n\nexport class ProgressBar {\n  static animationDuration = 300/*ms*/\n\n  static get defaultCSS() {\n    return unindent`\n      .turbolinks-progress-bar {\n        position: fixed;\n        display: block;\n        top: 0;\n        left: 0;\n        height: 3px;\n        background: #0076ff;\n        z-index: 9999;\n        transition:\n          width ${ProgressBar.animationDuration}ms ease-out,\n          opacity ${ProgressBar.animationDuration / 2}ms ${ProgressBar.animationDuration / 2}ms ease-in;\n        transform: translate3d(0, 0, 0);\n      }\n    `\n  }\n\n  readonly stylesheetElement = this.createStylesheetElement()\n  readonly progressElement = this.createProgressElement()\n\n  hiding = false\n  trickleInterval?: number\n  value = 0\n  visible = false\n\n  show() {\n    if (!this.visible) {\n      this.visible = true\n      this.installStylesheetElement()\n      this.installProgressElement()\n      this.startTrickling()\n    }\n  }\n\n  hide() {\n    if (this.visible && !this.hiding) {\n      this.hiding = true\n      this.fadeProgressElement(() => {\n        this.uninstallProgressElement()\n        this.stopTrickling()\n        this.visible = false\n        this.hiding = false\n      })\n    }\n  }\n\n  setValue(value: number) {\n    this.value = value\n    this.refresh()\n  }\n\n  // Private\n\n  installStylesheetElement() {\n    document.head.insertBefore(this.stylesheetElement, document.head.firstChild)\n  }\n\n  installProgressElement() {\n    this.progressElement.style.width = \"0\"\n    this.progressElement.style.opacity = \"1\"\n    document.documentElement.insertBefore(this.progressElement, document.body)\n    this.refresh()\n  }\n\n  fadeProgressElement(callback: () => void) {\n    this.progressElement.style.opacity = \"0\"\n    setTimeout(callback, ProgressBar.animationDuration * 1.5)\n  }\n\n  uninstallProgressElement() {\n    if (this.progressElement.parentNode) {\n      document.documentElement.removeChild(this.progressElement)\n    }\n  }\n\n  startTrickling() {\n    if (!this.trickleInterval) {\n      this.trickleInterval = window.setInterval(this.trickle, ProgressBar.animationDuration)\n    }\n  }\n\n  stopTrickling() {\n    window.clearInterval(this.trickleInterval)\n    delete this.trickleInterval\n  }\n\n  trickle = () => {\n    this.setValue(this.value + Math.random() / 100)\n  }\n\n  refresh() {\n    requestAnimationFrame(() => {\n      this.progressElement.style.width = `${10 + (this.value * 90)}%`\n    })\n  }\n\n  createStylesheetElement() {\n    const element = document.createElement(\"style\")\n    element.type = \"text/css\"\n    element.textContent = ProgressBar.defaultCSS\n    return element\n  }\n\n  createProgressElement() {\n    const element = document.createElement(\"div\")\n    element.className = \"turbolinks-progress-bar\"\n    return element\n  }\n}\n","import { Adapter } from \"./adapter\"\nimport { Controller } from \"./controller\"\nimport { SystemStatusCode } from \"./http_request\"\nimport { Locatable } from \"./location\"\nimport { ProgressBar } from \"./progress_bar\"\nimport { Action } from \"./types\"\nimport { Visit } from \"./visit\"\nimport { uuid } from \"./util\"\n\nexport class BrowserAdapter implements Adapter {\n  readonly controller: Controller\n  readonly progressBar = new ProgressBar\n\n  progressBarTimeout?: number\n\n  constructor(controller: Controller) {\n    this.controller = controller\n  }\n\n  visitProposedToLocationWithAction(location: Locatable, action: Action) {\n    const restorationIdentifier = uuid()\n    this.controller.startVisitToLocationWithAction(location, action, restorationIdentifier)\n  }\n\n  visitStarted(visit: Visit) {\n    visit.issueRequest()\n    visit.changeHistory()\n    visit.loadCachedSnapshot()\n  }\n\n  visitRequestStarted(visit: Visit) {\n    this.progressBar.setValue(0)\n    if (visit.hasCachedSnapshot() || visit.action != \"restore\") {\n      this.showProgressBarAfterDelay()\n    } else {\n      this.showProgressBar()\n    }\n  }\n\n  visitRequestProgressed(visit: Visit) {\n    this.progressBar.setValue(visit.progress)\n  }\n\n  visitRequestCompleted(visit: Visit) {\n    visit.loadResponse()\n  }\n\n  visitRequestFailedWithStatusCode(visit: Visit, statusCode: number) {\n    switch (statusCode) {\n      case SystemStatusCode.networkFailure:\n      case SystemStatusCode.timeoutFailure:\n      case SystemStatusCode.contentTypeMismatch:\n        return this.reload()\n      default:\n        return visit.loadResponse()\n    }\n  }\n\n  visitRequestFinished(visit: Visit) {\n    this.hideProgressBar()\n  }\n\n  visitCompleted(visit: Visit) {\n    visit.followRedirect()\n  }\n\n  pageInvalidated() {\n    this.reload()\n  }\n\n  visitFailed(visit: Visit) {\n\n  }\n\n  visitRendered(visit: Visit) {\n\n  }\n\n  // Private\n\n  showProgressBarAfterDelay() {\n    this.progressBarTimeout = window.setTimeout(this.showProgressBar, this.controller.progressBarDelay)\n  }\n\n  showProgressBar = () => {\n    this.progressBar.show()\n  }\n\n  hideProgressBar() {\n    this.progressBar.hide()\n    if (this.progressBarTimeout != null) {\n      window.clearTimeout(this.progressBarTimeout)\n      delete this.progressBarTimeout\n    }\n  }\n\n  reload() {\n    window.location.reload()\n  }\n}\n","import { Location } from \"./location\"\nimport { defer } from \"./util\"\n\nexport interface HistoryDelegate {\n  historyPoppedToLocationWithRestorationIdentifier(location: Location, restorationIdentifier: string): void\n}\n\ntype HistoryMethod = (state: any, title: string, url?: string | null | undefined) => void\n\nexport class History {\n  readonly delegate: HistoryDelegate\n  started = false\n  pageLoaded = false\n\n  constructor(delegate: HistoryDelegate) {\n    this.delegate = delegate\n  }\n\n  start() {\n    if (!this.started) {\n      addEventListener(\"popstate\", this.onPopState, false)\n      addEventListener(\"load\", this.onPageLoad, false)\n      this.started = true\n    }\n  }\n\n  stop() {\n    if (this.started) {\n      removeEventListener(\"popstate\", this.onPopState, false)\n      removeEventListener(\"load\", this.onPageLoad, false)\n      this.started = false\n    }\n  }\n\n  push(location: Location, restorationIdentifier: string) {\n    this.update(history.pushState, location, restorationIdentifier)\n  }\n\n  replace(location: Location, restorationIdentifier: string) {\n    this.update(history.replaceState, location, restorationIdentifier)\n  }\n\n  // Event handlers\n\n  onPopState = (event: PopStateEvent) => {\n    if (this.shouldHandlePopState()) {\n      const { turbolinks } = event.state\n      if (turbolinks) {\n        const location = Location.currentLocation\n        const { restorationIdentifier } = turbolinks\n        this.delegate.historyPoppedToLocationWithRestorationIdentifier(location, restorationIdentifier)\n      }\n    }\n  }\n\n  onPageLoad = (event: Event) => {\n    defer(() => {\n      this.pageLoaded = true\n    })\n  }\n\n  // Private\n\n  shouldHandlePopState() {\n    // Safari dispatches a popstate event after window's load event, ignore it\n    return this.pageIsLoaded()\n  }\n\n  pageIsLoaded() {\n    return this.pageLoaded || document.readyState == \"complete\"\n  }\n\n  update(method: HistoryMethod, location: Location, restorationIdentifier: string) {\n    const state = { turbolinks: { restorationIdentifier } }\n    method.call(history, state, \"\", location.absoluteURL)\n  }\n}\n","import { Position } from \"./types\"\n\nexport interface ScrollManagerDelegate {\n  scrollPositionChanged(position: Position): void\n}\n\nexport class ScrollManager {\n  readonly delegate: ScrollManagerDelegate\n  started = false\n\n  constructor(delegate: ScrollManagerDelegate) {\n    this.delegate = delegate\n  }\n\n  start() {\n    if (!this.started) {\n      addEventListener(\"scroll\", this.onScroll, false)\n      this.onScroll()\n      this.started = true\n    }\n  }\n\n  stop() {\n    if (this.started) {\n      removeEventListener(\"scroll\", this.onScroll, false)\n      this.started = false\n    }\n  }\n\n  scrollToElement(element: Element) {\n    element.scrollIntoView()\n  }\n\n  scrollToPosition({ x, y }: Position) {\n    window.scrollTo(x, y)\n  }\n\n  onScroll = () => {\n    this.updatePosition({ x: window.pageXOffset, y: window.pageYOffset })\n  }\n\n  // Private\n\n  updatePosition(position: Position) {\n    this.delegate.scrollPositionChanged(position)\n  }\n}\n","import { Location } from \"./location\"\nimport { Snapshot } from \"./snapshot\"\n\nexport class SnapshotCache {\n  readonly keys: string[] = []\n  readonly snapshots: { [url: string]: Snapshot } = {}\n  readonly size: number\n\n  constructor(size: number) {\n    this.size = size\n  }\n\n  has(location: Location) {\n    return location.toCacheKey() in this.snapshots\n  }\n\n  get(location: Location): Snapshot | undefined {\n    if (this.has(location)) {\n      const snapshot = this.read(location)\n      this.touch(location)\n      return snapshot\n    }\n  }\n\n  put(location: Location, snapshot: Snapshot) {\n    this.write(location, snapshot)\n    this.touch(location)\n    return snapshot\n  }\n\n  // Private\n\n  read(location: Location) {\n    return this.snapshots[location.toCacheKey()]\n  }\n\n  write(location: Location, snapshot: Snapshot) {\n    this.snapshots[location.toCacheKey()] = snapshot\n  }\n\n  touch(location: Location) {\n    const key = location.toCacheKey()\n    const index = this.keys.indexOf(key)\n    if (index > -1) this.keys.splice(index, 1)\n    this.keys.unshift(key)\n    this.trim()\n  }\n\n  trim() {\n    for (const key of this.keys.splice(this.size)) {\n      delete this.snapshots[key]\n    }\n  }\n}\n","export type Action = \"advance\" | \"replace\" | \"restore\"\n\nexport function isAction(action: any): action is Action {\n  return action == \"advance\" || action == \"replace\" || action == \"restore\"\n}\n\nexport type Position = { x: number, y: number }\n","import { array } from \"./util\"\n\nexport type RenderCallback = () => void\n\nexport interface RenderDelegate {\n  viewWillRender(newBody: HTMLBodyElement): void\n  viewRendered(newBody: HTMLBodyElement): void\n  viewInvalidated(): void\n}\n\nexport abstract class Renderer {\n  abstract delegate: RenderDelegate\n  abstract newBody: HTMLBodyElement\n\n  renderView(callback: RenderCallback) {\n    this.delegate.viewWillRender(this.newBody)\n    callback()\n    this.delegate.viewRendered(this.newBody)\n  }\n\n  invalidateView() {\n    this.delegate.viewInvalidated()\n  }\n\n  createScriptElement(element: Element) {\n    if (element.getAttribute(\"data-turbolinks-eval\") == \"false\") {\n      return element\n    } else {\n      const createdScriptElement = document.createElement(\"script\")\n      createdScriptElement.textContent = element.textContent\n      createdScriptElement.async = false\n      copyElementAttributes(createdScriptElement, element)\n      return createdScriptElement\n    }\n  }\n}\n\nfunction copyElementAttributes(destinationElement: Element, sourceElement: Element) {\n  for (const { name, value } of array(sourceElement.attributes)) {\n    destinationElement.setAttribute(name, value)\n  }\n}\n","import { RenderCallback, RenderDelegate, Renderer } from \"./renderer\"\nimport { array } from \"./util\"\n\nexport class ErrorRenderer extends Renderer {\n  readonly delegate: RenderDelegate\n  readonly htmlElement: HTMLHtmlElement\n  readonly newHead: HTMLHeadElement\n  readonly newBody: HTMLBodyElement\n\n  static render(delegate: RenderDelegate, callback: RenderCallback, html: string) {\n    return new this(delegate, html).render(callback)\n  }\n\n  constructor(delegate: RenderDelegate, html: string) {\n    super()\n    this.delegate = delegate\n    this.htmlElement = (() => {\n      const htmlElement = document.createElement(\"html\")\n      htmlElement.innerHTML = html\n      return htmlElement\n    })()\n    this.newHead = this.htmlElement.querySelector(\"head\") || document.createElement(\"head\")\n    this.newBody = this.htmlElement.querySelector(\"body\") || document.createElement(\"body\")\n  }\n\n  render(callback: RenderCallback) {\n    this.renderView(() => {\n      this.replaceHeadAndBody()\n      this.activateBodyScriptElements()\n      callback()\n    })\n  }\n\n  replaceHeadAndBody() {\n    const { documentElement, head, body } = document\n    documentElement.replaceChild(this.newHead, head)\n    documentElement.replaceChild(this.newBody, body)\n  }\n\n  activateBodyScriptElements() {\n    for (const replaceableElement of this.getScriptElements()) {\n      const parentNode = replaceableElement.parentNode\n      if (parentNode) {\n        const element = this.createScriptElement(replaceableElement)\n        parentNode.replaceChild(element, replaceableElement)\n      }\n    }\n  }\n\n  getScriptElements() {\n    return array(document.documentElement.querySelectorAll(\"script\"))\n  }\n}\n","import { array } from \"./util\"\n\ntype ElementDetailMap = { [outerHTML: string]: ElementDetails }\n\ntype ElementDetails = { type?: ElementType, tracked: boolean, elements: Element[] }\n\ntype ElementType = \"script\" | \"stylesheet\"\n\nexport class HeadDetails {\n  readonly detailsByOuterHTML: ElementDetailMap\n\n  static fromHeadElement(headElement: HTMLHeadElement | null): HeadDetails {\n    const children = headElement ? array(headElement.children) : []\n    return new this(children)\n  }\n\n  constructor(children: Element[]) {\n    this.detailsByOuterHTML = children.reduce((result, element) => {\n      const { outerHTML } = element\n      const details: ElementDetails\n        = outerHTML in result\n        ? result[outerHTML]\n        : {\n          type: elementType(element),\n          tracked: elementIsTracked(element),\n          elements: []\n        }\n      return {\n        ...result,\n        [outerHTML]: {\n          ...details,\n          elements: [...details.elements, element]\n        }\n      }\n    }, {} as ElementDetailMap)\n  }\n\n  getTrackedElementSignature(): string {\n    return Object.keys(this.detailsByOuterHTML)\n      .filter(outerHTML => this.detailsByOuterHTML[outerHTML].tracked)\n      .join(\"\")\n  }\n\n  getScriptElementsNotInDetails(headDetails: HeadDetails) {\n    return this.getElementsMatchingTypeNotInDetails(\"script\", headDetails)\n  }\n\n  getStylesheetElementsNotInDetails(headDetails: HeadDetails) {\n    return this.getElementsMatchingTypeNotInDetails(\"stylesheet\", headDetails)\n  }\n\n  getElementsMatchingTypeNotInDetails(matchedType: ElementType, headDetails: HeadDetails) {\n    return Object.keys(this.detailsByOuterHTML)\n      .filter(outerHTML => !(outerHTML in headDetails.detailsByOuterHTML))\n      .map(outerHTML => this.detailsByOuterHTML[outerHTML])\n      .filter(({ type }) => type == matchedType)\n      .map(({ elements: [element] }) => element)\n  }\n\n  getProvisionalElements(): Element[] {\n    return Object.keys(this.detailsByOuterHTML).reduce((result, outerHTML) => {\n      const { type, tracked, elements } = this.detailsByOuterHTML[outerHTML]\n      if (type == null && !tracked) {\n        return [...result, ...elements]\n      } else if (elements.length > 1) {\n        return [...result, ...elements.slice(1)]\n      } else {\n        return result\n      }\n    }, [] as Element[])\n  }\n\n  getMetaValue(name: string): string | null {\n    const element = this.findMetaElementByName(name)\n    return element\n      ? element.getAttribute(\"content\")\n      : null\n  }\n\n  findMetaElementByName(name: string) {\n    return Object.keys(this.detailsByOuterHTML).reduce((result, outerHTML) => {\n      const { elements: [element] } = this.detailsByOuterHTML[outerHTML]\n      return elementIsMetaElementWithName(element, name) ? element : result\n    }, undefined as Element | undefined)\n  }\n}\n\nfunction elementType(element: Element) {\n  if (elementIsScript(element)) {\n    return \"script\"\n  } else if (elementIsStylesheet(element)) {\n    return \"stylesheet\"\n  }\n}\n\nfunction elementIsTracked(element: Element) {\n  return element.getAttribute(\"data-turbolinks-track\") == \"reload\"\n}\n\nfunction elementIsScript(element: Element) {\n  const tagName = element.tagName.toLowerCase()\n  return tagName == \"script\"\n}\n\nfunction elementIsStylesheet(element: Element) {\n  const tagName = element.tagName.toLowerCase()\n  return tagName == \"style\" || (tagName == \"link\" && element.getAttribute(\"rel\") == \"stylesheet\")\n}\n\nfunction elementIsMetaElementWithName(element: Element, name: string) {\n  const tagName = element.tagName.toLowerCase()\n  return tagName == \"meta\" && element.getAttribute(\"name\") == name\n}\n","import { HeadDetails } from \"./head_details\"\nimport { Location } from \"./location\"\nimport { array } from \"./util\"\n\nexport class Snapshot {\n  static wrap(value: Snapshot | string | HTMLHtmlElement) {\n    if (value instanceof this) {\n      return value\n    } else if (typeof value == \"string\") {\n      return this.fromHTMLString(value)\n    } else {\n      return this.fromHTMLElement(value)\n    }\n  }\n\n  static fromHTMLString(html: string) {\n    const element = document.createElement(\"html\")\n    element.innerHTML = html\n    return this.fromHTMLElement(element)\n  }\n\n  static fromHTMLElement(htmlElement: HTMLHtmlElement) {\n    const headElement = htmlElement.querySelector(\"head\")\n    const bodyElement = htmlElement.querySelector(\"body\") || document.createElement(\"body\")\n    const headDetails = HeadDetails.fromHeadElement(headElement)\n    return new this(headDetails, bodyElement)\n  }\n\n  readonly headDetails: HeadDetails\n  readonly bodyElement: HTMLBodyElement\n\n  constructor(headDetails: HeadDetails, bodyElement: HTMLBodyElement) {\n    this.headDetails = headDetails\n    this.bodyElement = bodyElement\n  }\n\n  clone(): Snapshot {\n    return new Snapshot(this.headDetails, this.bodyElement.cloneNode(true))\n  }\n\n  getRootLocation() {\n    const root = this.getSetting(\"root\", \"/\")\n    return new Location(root)\n  }\n\n  getCacheControlValue() {\n    return this.getSetting(\"cache-control\")\n  }\n\n  getElementForAnchor(anchor: string) {\n    try {\n      return this.bodyElement.querySelector(`[id='${anchor}'], a[name='${anchor}']`)\n    } catch {\n      return null\n    }\n  }\n\n  getPermanentElements() {\n    return array(this.bodyElement.querySelectorAll(\"[id][data-turbolinks-permanent]\"))\n  }\n\n  getPermanentElementById(id: string) {\n    return this.bodyElement.querySelector(`#${id}[data-turbolinks-permanent]`)\n  }\n\n  getPermanentElementsPresentInSnapshot(snapshot: Snapshot) {\n    return this.getPermanentElements().filter(({ id }) => snapshot.getPermanentElementById(id))\n  }\n\n  findFirstAutofocusableElement() {\n    return this.bodyElement.querySelector(\"[autofocus]\")\n  }\n\n  hasAnchor(anchor: string) {\n    return this.getElementForAnchor(anchor) != null\n  }\n\n  isPreviewable() {\n    return this.getCacheControlValue() != \"no-preview\"\n  }\n\n  isCacheable() {\n    return this.getCacheControlValue() != \"no-cache\"\n  }\n\n  isVisitable() {\n    return this.getSetting(\"visit-control\") != \"reload\"\n  }\n\n  // Private\n\n  getSetting(name: string): string | undefined\n  getSetting(name: string, defaultValue: string): string\n  getSetting(name: string, defaultValue?: string) {\n    const value = this.headDetails.getMetaValue(`turbolinks-${name}`)\n    return value == null ? defaultValue : value\n  }\n}\n","import { HeadDetails } from \"./head_details\"\nimport { RenderCallback, RenderDelegate, Renderer } from \"./renderer\"\nimport { Snapshot } from \"./snapshot\"\nimport { array } from \"./util\"\n\nexport { RenderCallback, RenderDelegate } from \"./renderer\"\n\nexport type PermanentElement = Element & { id: string }\n\nexport type Placeholder = { element: Element, permanentElement: PermanentElement }\n\nexport class SnapshotRenderer extends Renderer {\n  readonly delegate: RenderDelegate\n  readonly currentSnapshot: Snapshot\n  readonly currentHeadDetails: HeadDetails\n  readonly newSnapshot: Snapshot\n  readonly newHeadDetails: HeadDetails\n  readonly newBody: HTMLBodyElement\n  readonly isPreview: boolean\n\n  static render(delegate: RenderDelegate, callback: RenderCallback, currentSnapshot: Snapshot, newSnapshot: Snapshot, isPreview: boolean) {\n    return new this(delegate, currentSnapshot, newSnapshot, isPreview).render(callback)\n  }\n\n  constructor(delegate: RenderDelegate, currentSnapshot: Snapshot, newSnapshot: Snapshot, isPreview: boolean) {\n    super()\n    this.delegate = delegate\n    this.currentSnapshot = currentSnapshot\n    this.currentHeadDetails = currentSnapshot.headDetails\n    this.newSnapshot = newSnapshot\n    this.newHeadDetails = newSnapshot.headDetails\n    this.newBody = newSnapshot.bodyElement\n    this.isPreview = isPreview\n  }\n\n  render(callback: RenderCallback) {\n    if (this.shouldRender()) {\n      this.mergeHead()\n      this.renderView(() => {\n        this.replaceBody()\n        if (!this.isPreview) {\n          this.focusFirstAutofocusableElement()\n        }\n        callback()\n      })\n    } else {\n      this.invalidateView()\n    }\n  }\n\n  mergeHead() {\n    this.copyNewHeadStylesheetElements()\n    this.copyNewHeadScriptElements()\n    this.removeCurrentHeadProvisionalElements()\n    this.copyNewHeadProvisionalElements()\n  }\n\n  replaceBody() {\n    const placeholders = this.relocateCurrentBodyPermanentElements()\n    this.activateNewBodyScriptElements()\n    this.assignNewBody()\n    this.replacePlaceholderElementsWithClonedPermanentElements(placeholders)\n  }\n\n  shouldRender() {\n    return this.newSnapshot.isVisitable() && this.trackedElementsAreIdentical()\n  }\n\n  trackedElementsAreIdentical() {\n    return this.currentHeadDetails.getTrackedElementSignature() == this.newHeadDetails.getTrackedElementSignature()\n  }\n\n  copyNewHeadStylesheetElements() {\n    for (const element of this.getNewHeadStylesheetElements()) {\n      document.head.appendChild(element)\n    }\n  }\n\n  copyNewHeadScriptElements() {\n    for (const element of this.getNewHeadScriptElements()) {\n      document.head.appendChild(this.createScriptElement(element))\n    }\n  }\n\n  removeCurrentHeadProvisionalElements() {\n    for (const element of this.getCurrentHeadProvisionalElements()) {\n      document.head.removeChild(element)\n    }\n  }\n\n  copyNewHeadProvisionalElements() {\n    for (const element of this.getNewHeadProvisionalElements()) {\n      document.head.appendChild(element)\n    }\n  }\n\n  relocateCurrentBodyPermanentElements() {\n    return this.getCurrentBodyPermanentElements().reduce((placeholders, permanentElement) => {\n      const newElement = this.newSnapshot.getPermanentElementById(permanentElement.id)\n      if (newElement) {\n        const placeholder = createPlaceholderForPermanentElement(permanentElement)\n        replaceElementWithElement(permanentElement, placeholder.element)\n        replaceElementWithElement(newElement, permanentElement)\n        return [...placeholders, placeholder]\n      } else {\n        return placeholders\n      }\n    }, [] as Placeholder[])\n  }\n\n  replacePlaceholderElementsWithClonedPermanentElements(placeholders: Placeholder[]) {\n    for (const { element, permanentElement } of placeholders) {\n      const clonedElement = permanentElement.cloneNode(true)\n      replaceElementWithElement(element, clonedElement)\n    }\n  }\n\n  activateNewBodyScriptElements() {\n    for (const inertScriptElement of this.getNewBodyScriptElements()) {\n      const activatedScriptElement = this.createScriptElement(inertScriptElement)\n      replaceElementWithElement(inertScriptElement, activatedScriptElement)\n    }\n  }\n\n  assignNewBody() {\n    replaceElementWithElement(document.body, this.newBody)\n  }\n\n  focusFirstAutofocusableElement() {\n    const element = this.newSnapshot.findFirstAutofocusableElement()\n    if (elementIsFocusable(element)) {\n      element.focus()\n    }\n  }\n\n  getNewHeadStylesheetElements() {\n    return this.newHeadDetails.getStylesheetElementsNotInDetails(this.currentHeadDetails)\n  }\n\n  getNewHeadScriptElements() {\n    return this.newHeadDetails.getScriptElementsNotInDetails(this.currentHeadDetails)\n  }\n\n  getCurrentHeadProvisionalElements() {\n    return this.currentHeadDetails.getProvisionalElements()\n  }\n\n  getNewHeadProvisionalElements() {\n    return this.newHeadDetails.getProvisionalElements()\n  }\n\n  getCurrentBodyPermanentElements(): PermanentElement[] {\n    return this.currentSnapshot.getPermanentElementsPresentInSnapshot(this.newSnapshot)\n  }\n\n  getNewBodyScriptElements() {\n    return array(this.newBody.querySelectorAll(\"script\"))\n  }\n}\n\nfunction createPlaceholderForPermanentElement(permanentElement: PermanentElement) {\n  const element = document.createElement(\"meta\")\n  element.setAttribute(\"name\", \"turbolinks-permanent-placeholder\")\n  element.setAttribute(\"content\", permanentElement.id)\n  return { element, permanentElement }\n}\n\nfunction replaceElementWithElement(fromElement: Element, toElement: Element) {\n  const parentElement = fromElement.parentElement\n  if (parentElement) {\n    return parentElement.replaceChild(toElement, fromElement)\n  }\n}\n\nfunction elementIsFocusable(element: any): element is { focus: () => void } {\n  return element && typeof element.focus == \"function\"\n}\n","import { ErrorRenderer } from \"./error_renderer\"\nimport { Location } from \"./location\"\nimport { Snapshot } from \"./snapshot\"\nimport { RenderCallback, RenderDelegate, SnapshotRenderer } from \"./snapshot_renderer\"\n\nexport type RenderOptions = { snapshot: Snapshot, error: string, isPreview: boolean }\n\nexport class View {\n  readonly delegate: RenderDelegate\n  readonly htmlElement = document.documentElement as HTMLHtmlElement\n\n  constructor(delegate: RenderDelegate) {\n    this.delegate = delegate\n  }\n\n  getRootLocation(): Location {\n    return this.getSnapshot().getRootLocation()\n  }\n\n  getElementForAnchor(anchor: string) {\n    return this.getSnapshot().getElementForAnchor(anchor)\n  }\n\n  getSnapshot(): Snapshot {\n    return Snapshot.fromHTMLElement(this.htmlElement)\n  }\n\n  render({ snapshot, error, isPreview }: Partial<RenderOptions>, callback: RenderCallback) {\n    this.markAsPreview(isPreview)\n    if (snapshot) {\n      this.renderSnapshot(snapshot, isPreview, callback)\n    } else {\n      this.renderError(error, callback)\n    }\n  }\n\n  // Private\n\n  markAsPreview(isPreview: boolean | undefined) {\n    if (isPreview) {\n      this.htmlElement.setAttribute(\"data-turbolinks-preview\", \"\")\n    } else {\n      this.htmlElement.removeAttribute(\"data-turbolinks-preview\")\n    }\n  }\n\n  renderSnapshot(snapshot: Snapshot, isPreview: boolean | undefined, callback: RenderCallback) {\n    SnapshotRenderer.render(this.delegate, callback, this.getSnapshot(), snapshot, isPreview || false)\n  }\n\n  renderError(error: string | undefined, callback: RenderCallback) {\n    ErrorRenderer.render(this.delegate, callback, error || \"\")\n  }\n}\n","import { Adapter } from \"./adapter\"\nimport { Controller, RestorationData } from \"./controller\"\nimport { HttpRequest } from \"./http_request\"\nimport { Location } from \"./location\"\nimport { RenderCallback } from \"./renderer\"\nimport { Snapshot } from \"./snapshot\"\nimport { Action } from \"./types\"\nimport { uuid } from \"./util\"\n\nexport enum TimingMetric {\n  visitStart = \"visitStart\",\n  requestStart = \"requestStart\",\n  requestEnd = \"requestEnd\",\n  visitEnd = \"visitEnd\"\n}\n\nexport type TimingMetrics = Partial<{ [metric in TimingMetric]: any }>\n\nexport enum VisitState {\n  initialized = \"initialized\",\n  started = \"started\",\n  canceled = \"canceled\",\n  failed = \"failed\",\n  completed = \"completed\"\n}\n\nexport class Visit {\n  readonly controller: Controller\n  readonly action: Action\n  readonly adapter: Adapter\n  readonly identifier = uuid()\n  readonly restorationIdentifier: string\n  readonly timingMetrics: TimingMetrics = {}\n\n  followedRedirect = false\n  frame?: number\n  historyChanged = false\n  location: Location\n  progress = 0\n  referrer?: Location\n  redirectedToLocation?: Location\n  request?: HttpRequest\n  response?: string\n  restorationData?: RestorationData\n  scrolled = false\n  snapshotCached = false\n  state = VisitState.initialized\n\n  constructor(controller: Controller, location: Location, action: Action, restorationIdentifier: string = uuid()) {\n    this.controller = controller\n    this.location = location\n    this.action = action\n    this.adapter = controller.adapter\n    this.restorationIdentifier = restorationIdentifier\n  }\n\n  start() {\n    if (this.state == VisitState.initialized) {\n      this.recordTimingMetric(TimingMetric.visitStart)\n      this.state = VisitState.started\n      this.adapter.visitStarted(this)\n    }\n  }\n\n  cancel() {\n    if (this.state == VisitState.started) {\n      if (this.request) {\n        this.request.cancel()\n      }\n      this.cancelRender()\n      this.state = VisitState.canceled\n    }\n  }\n\n  complete() {\n    if (this.state == VisitState.started) {\n      this.recordTimingMetric(TimingMetric.visitEnd)\n      this.state = VisitState.completed\n      this.adapter.visitCompleted(this)\n      this.controller.visitCompleted(this)\n    }\n  }\n\n  fail() {\n    if (this.state == VisitState.started) {\n      this.state = VisitState.failed\n      this.adapter.visitFailed(this)\n    }\n  }\n\n  changeHistory() {\n    if (!this.historyChanged) {\n      const actionForHistory = this.location.isEqualTo(this.referrer) ? \"replace\" : this.action\n      const method = this.getHistoryMethodForAction(actionForHistory)\n      method.call(this.controller, this.location, this.restorationIdentifier)\n      this.historyChanged = true\n    }\n  }\n\n  issueRequest() {\n    if (this.shouldIssueRequest() && !this.request) {\n      this.progress = 0\n      this.request = new HttpRequest(this, this.location, this.referrer)\n      this.request.send()\n    }\n  }\n\n  getCachedSnapshot() {\n    const snapshot = this.controller.getCachedSnapshotForLocation(this.location)\n    if (snapshot && (!this.location.anchor || snapshot.hasAnchor(this.location.anchor))) {\n      if (this.action == \"restore\" || snapshot.isPreviewable()) {\n        return snapshot\n      }\n    }\n  }\n\n  hasCachedSnapshot() {\n    return this.getCachedSnapshot() != null\n  }\n\n  loadCachedSnapshot() {\n    const snapshot = this.getCachedSnapshot()\n    if (snapshot) {\n      const isPreview = this.shouldIssueRequest()\n      this.render(() => {\n        this.cacheSnapshot()\n        this.controller.render({ snapshot, isPreview }, this.performScroll)\n        this.adapter.visitRendered(this)\n        if (!isPreview) {\n          this.complete()\n        }\n      })\n    }\n  }\n\n  loadResponse() {\n    const { request, response } = this\n    if (request && response) {\n      this.render(() => {\n        this.cacheSnapshot()\n        if (request.failed) {\n          this.controller.render({ error: this.response }, this.performScroll)\n          this.adapter.visitRendered(this)\n          this.fail()\n        } else {\n          this.controller.render({ snapshot: Snapshot.fromHTMLString(response) }, this.performScroll)\n          this.adapter.visitRendered(this)\n          this.complete()\n        }\n      })\n    }\n  }\n\n  followRedirect() {\n    if (this.redirectedToLocation && !this.followedRedirect) {\n      this.location = this.redirectedToLocation\n      this.controller.replaceHistoryWithLocationAndRestorationIdentifier(this.redirectedToLocation, this.restorationIdentifier)\n      this.followedRedirect = true\n    }\n  }\n\n  // HTTP request delegate\n\n  requestStarted() {\n    this.recordTimingMetric(TimingMetric.requestStart)\n    this.adapter.visitRequestStarted(this)\n  }\n\n  requestProgressed(progress: number) {\n    this.progress = progress\n    if (this.adapter.visitRequestProgressed) {\n      this.adapter.visitRequestProgressed(this)\n    }\n  }\n\n  requestCompletedWithResponse(response: string, redirectedToLocation?: Location) {\n    this.response = response\n    this.redirectedToLocation = redirectedToLocation\n    this.adapter.visitRequestCompleted(this)\n  }\n\n  requestFailedWithStatusCode(statusCode: number, response?: string) {\n    this.response = response\n    this.adapter.visitRequestFailedWithStatusCode(this, statusCode)\n  }\n\n  requestFinished() {\n    this.recordTimingMetric(TimingMetric.requestEnd)\n    this.adapter.visitRequestFinished(this)\n  }\n\n  // Scrolling\n\n  performScroll = () => {\n    if (!this.scrolled) {\n      if (this.action == \"restore\") {\n        this.scrollToRestoredPosition() || this.scrollToTop()\n      } else {\n        this.scrollToAnchor() || this.scrollToTop()\n      }\n      this.scrolled = true\n    }\n  }\n\n  scrollToRestoredPosition() {\n    const position = this.restorationData ? this.restorationData.scrollPosition : undefined\n    if (position) {\n      this.controller.scrollToPosition(position)\n      return true\n    }\n  }\n\n  scrollToAnchor() {\n    if (this.location.anchor != null) {\n      this.controller.scrollToAnchor(this.location.anchor)\n      return true\n    }\n  }\n\n  scrollToTop() {\n    this.controller.scrollToPosition({ x: 0, y: 0 })\n  }\n\n  // Instrumentation\n\n  recordTimingMetric(metric: TimingMetric) {\n    this.timingMetrics[metric] = new Date().getTime()\n  }\n\n  getTimingMetrics(): TimingMetrics {\n    return { ...this.timingMetrics }\n  }\n\n  // Private\n\n  getHistoryMethodForAction(action: Action) {\n    switch (action) {\n      case \"replace\": return this.controller.replaceHistoryWithLocationAndRestorationIdentifier\n      case \"advance\":\n      case \"restore\": return this.controller.pushHistoryWithLocationAndRestorationIdentifier\n    }\n  }\n    shouldIssueRequest() {\n    return this.action == \"restore\"\n      ? !this.hasCachedSnapshot()\n      : true\n  }\n\n  cacheSnapshot() {\n    if (!this.snapshotCached) {\n      this.controller.cacheSnapshot()\n      this.snapshotCached = true\n    }\n  }\n\n  render(callback: RenderCallback) {\n    this.cancelRender()\n    this.frame = requestAnimationFrame(() => {\n      delete this.frame\n      callback.call(this)\n    })\n  }\n\n  cancelRender() {\n    if (this.frame) {\n      cancelAnimationFrame(this.frame)\n      delete this.frame\n    }\n  }\n}\n","import { Adapter } from \"./adapter\"\nimport { BrowserAdapter } from \"./browser_adapter\"\nimport { History } from \"./history\"\nimport { Location, Locatable } from \"./location\"\nimport { RenderCallback } from \"./renderer\"\nimport { ScrollManager } from \"./scroll_manager\"\nimport { SnapshotCache } from \"./snapshot_cache\"\nimport { Action, Position, isAction } from \"./types\"\nimport { closest, defer, dispatch, uuid } from \"./util\"\nimport { RenderOptions, View } from \"./view\"\nimport { Visit } from \"./visit\"\n\nexport type RestorationData = { scrollPosition?: Position }\nexport type RestorationDataMap = { [uuid: string]: RestorationData }\nexport type TimingData = {}\nexport type VisitOptions = { action: Action }\nexport type VisitProperties = { restorationIdentifier: string, restorationData: RestorationData, historyChanged: boolean }\n\nexport class Controller {\n  static supported = !!(\n    window.history.pushState &&\n    window.requestAnimationFrame &&\n    window.addEventListener\n  )\n\n  readonly adapter: Adapter = new BrowserAdapter(this)\n  readonly history = new History(this)\n  readonly restorationData: RestorationDataMap = {}\n  readonly scrollManager = new ScrollManager(this)\n  readonly view = new View(this)\n\n  cache = new SnapshotCache(10)\n  currentVisit?: Visit\n  enabled = true\n  lastRenderedLocation?: Location\n  location!: Location\n  progressBarDelay = 500\n  restorationIdentifier!: string\n  started = false\n\n  start() {\n    if (Controller.supported && !this.started) {\n      addEventListener(\"click\", this.clickCaptured, true)\n      addEventListener(\"DOMContentLoaded\", this.pageLoaded, false)\n      this.scrollManager.start()\n      this.startHistory()\n      this.started = true\n      this.enabled = true\n    }\n  }\n\n  disable() {\n    this.enabled = false\n  }\n\n  stop() {\n    if (this.started) {\n      removeEventListener(\"click\", this.clickCaptured, true)\n      removeEventListener(\"DOMContentLoaded\", this.pageLoaded, false)\n      this.scrollManager.stop()\n      this.stopHistory()\n      this.started = false\n    }\n  }\n\n  clearCache() {\n    this.cache = new SnapshotCache(10)\n  }\n\n  visit(location: Locatable, options: Partial<VisitOptions> = {}) {\n    location = Location.wrap(location)\n    if (this.applicationAllowsVisitingLocation(location)) {\n      if (this.locationIsVisitable(location)) {\n        const action = options.action || \"advance\"\n        this.adapter.visitProposedToLocationWithAction(location, action)\n      } else {\n        window.location.href = location.toString()\n      }\n    }\n  }\n\n  startVisitToLocationWithAction(location: Locatable, action: Action, restorationIdentifier: string) {\n    if (Controller.supported) {\n      const restorationData = this.getRestorationDataForIdentifier(restorationIdentifier)\n      this.startVisit(Location.wrap(location), action, { restorationData })\n    } else {\n      window.location.href = location.toString()\n    }\n  }\n\n  setProgressBarDelay(delay: number) {\n    this.progressBarDelay = delay\n  }\n\n  // History\n\n  startHistory() {\n    this.location = Location.currentLocation\n    this.restorationIdentifier = uuid()\n    this.history.start()\n    this.history.replace(this.location, this.restorationIdentifier)\n  }\n\n  stopHistory() {\n    this.history.stop()\n  }\n\n  pushHistoryWithLocationAndRestorationIdentifier(locatable: Locatable, restorationIdentifier: string) {\n    this.location = Location.wrap(locatable)\n    this.restorationIdentifier = restorationIdentifier\n    this.history.push(this.location, this.restorationIdentifier)\n  }\n\n  replaceHistoryWithLocationAndRestorationIdentifier(locatable: Locatable, restorationIdentifier: string) {\n    this.location = Location.wrap(locatable)\n    this.restorationIdentifier = restorationIdentifier\n    this.history.replace(this.location, this.restorationIdentifier)\n  }\n\n  // History delegate\n\n  historyPoppedToLocationWithRestorationIdentifier(location: Location, restorationIdentifier: string) {\n    if (this.enabled) {\n      this.location = location\n      this.restorationIdentifier = restorationIdentifier\n      const restorationData = this.getRestorationDataForIdentifier(restorationIdentifier)\n      this.startVisit(location, \"restore\", { restorationIdentifier, restorationData, historyChanged: true })\n    } else {\n      this.adapter.pageInvalidated()\n    }\n  }\n\n  // Snapshot cache\n\n  getCachedSnapshotForLocation(location: Location) {\n    const snapshot = this.cache.get(location)\n    return snapshot ? snapshot.clone() : snapshot\n  }\n\n  shouldCacheSnapshot() {\n    return this.view.getSnapshot().isCacheable()\n  }\n\n  cacheSnapshot() {\n    if (this.shouldCacheSnapshot()) {\n      this.notifyApplicationBeforeCachingSnapshot()\n      const snapshot = this.view.getSnapshot()\n      const location = this.lastRenderedLocation || Location.currentLocation\n      defer(() => this.cache.put(location, snapshot.clone()))\n    }\n  }\n\n  // Scrolling\n\n  scrollToAnchor(anchor: string) {\n    const element = this.view.getElementForAnchor(anchor)\n    if (element) {\n      this.scrollToElement(element)\n    } else {\n      this.scrollToPosition({ x: 0, y: 0 })\n    }\n  }\n\n  scrollToElement(element: Element) {\n    this.scrollManager.scrollToElement(element)\n  }\n\n  scrollToPosition(position: Position) {\n    this.scrollManager.scrollToPosition(position)\n  }\n\n  // Scroll manager delegate\n\n  scrollPositionChanged(position: Position) {\n    const restorationData = this.getCurrentRestorationData()\n    restorationData.scrollPosition = position\n  }\n\n  // View\n\n  render(options: Partial<RenderOptions>, callback: RenderCallback) {\n    this.view.render(options, callback)\n  }\n\n  viewInvalidated() {\n    this.adapter.pageInvalidated()\n  }\n\n  viewWillRender(newBody: HTMLBodyElement) {\n    this.notifyApplicationBeforeRender(newBody)\n  }\n\n  viewRendered() {\n    this.lastRenderedLocation = this.currentVisit!.location\n    this.notifyApplicationAfterRender()\n  }\n\n  // Event handlers\n\n  pageLoaded = () => {\n    this.lastRenderedLocation = this.location\n    this.notifyApplicationAfterPageLoad()\n  }\n\n  clickCaptured = () => {\n    removeEventListener(\"click\", this.clickBubbled, false)\n    addEventListener(\"click\", this.clickBubbled, false)\n  }\n\n  clickBubbled = (event: MouseEvent) => {\n    if (this.enabled && this.clickEventIsSignificant(event)) {\n      const link = this.getVisitableLinkForTarget(event.target)\n      if (link) {\n        const location = this.getVisitableLocationForLink(link)\n        if (location && this.applicationAllowsFollowingLinkToLocation(link, location)) {\n          event.preventDefault()\n          const action = this.getActionForLink(link)\n          this.visit(location, { action })\n        }\n      }\n    }\n  }\n\n  // Application events\n\n  applicationAllowsFollowingLinkToLocation(link: Element, location: Location) {\n    const event = this.notifyApplicationAfterClickingLinkToLocation(link, location)\n    return !event.defaultPrevented\n  }\n\n  applicationAllowsVisitingLocation(location: Location) {\n    const event = this.notifyApplicationBeforeVisitingLocation(location)\n    return !event.defaultPrevented\n  }\n\n  notifyApplicationAfterClickingLinkToLocation(link: Element, location: Location) {\n    return dispatch(\"turbolinks:click\", { target: link, data: { url: location.absoluteURL }, cancelable: true })\n  }\n\n  notifyApplicationBeforeVisitingLocation(location: Location) {\n    return dispatch(\"turbolinks:before-visit\", { data: { url: location.absoluteURL }, cancelable: true })\n  }\n\n  notifyApplicationAfterVisitingLocation(location: Location) {\n    return dispatch(\"turbolinks:visit\", { data: { url: location.absoluteURL } })\n  }\n\n  notifyApplicationBeforeCachingSnapshot() {\n    return dispatch(\"turbolinks:before-cache\")\n  }\n\n  notifyApplicationBeforeRender(newBody: HTMLBodyElement) {\n    return dispatch(\"turbolinks:before-render\", { data: { newBody }})\n  }\n\n  notifyApplicationAfterRender() {\n    return dispatch(\"turbolinks:render\")\n  }\n\n  notifyApplicationAfterPageLoad(timing: TimingData = {}) {\n    return dispatch(\"turbolinks:load\", { data: { url: this.location.absoluteURL, timing }})\n  }\n\n  // Private\n\n  startVisit(location: Location, action: Action, properties: Partial<VisitProperties>) {\n    if (this.currentVisit) {\n      this.currentVisit.cancel()\n    }\n    this.currentVisit = this.createVisit(location, action, properties)\n    this.currentVisit.start()\n    this.notifyApplicationAfterVisitingLocation(location)\n  }\n\n  createVisit(location: Location, action: Action, properties: Partial<VisitProperties>): Visit {\n    const visit = new Visit(this, location, action, properties.restorationIdentifier)\n    visit.restorationData = { ...(properties.restorationData || {}) }\n    visit.historyChanged = !!properties.historyChanged\n    visit.referrer = this.location\n    return visit\n  }\n\n  visitCompleted(visit: Visit) {\n    this.notifyApplicationAfterPageLoad(visit.getTimingMetrics())\n  }\n\n  clickEventIsSignificant(event: MouseEvent) {\n    return !(\n      (event.target && (event.target as any).isContentEditable)\n      || event.defaultPrevented\n      || event.which > 1\n      || event.altKey\n      || event.ctrlKey\n      || event.metaKey\n      || event.shiftKey\n    )\n  }\n\n  getVisitableLinkForTarget(target: EventTarget | null) {\n    if (target instanceof Element && this.elementIsVisitable(target)) {\n      return closest(target, \"a[href]:not([target]):not([download])\")\n    }\n  }\n\n  getVisitableLocationForLink(link: Element) {\n    const location = new Location(link.getAttribute(\"href\") || \"\")\n    if (this.locationIsVisitable(location)) {\n      return location\n    }\n  }\n\n  getActionForLink(link: Element): Action {\n    const action = link.getAttribute(\"data-turbolinks-action\")\n    return isAction(action) ? action : \"advance\"\n  }\n\n  elementIsVisitable(element: Element) {\n    const container = closest(element, \"[data-turbolinks]\")\n    if (container) {\n      return container.getAttribute(\"data-turbolinks\") != \"false\"\n    } else {\n      return true\n    }\n  }\n\n  locationIsVisitable(location: Location) {\n    return location.isPrefixedBy(this.view.getRootLocation()) && location.isHTML()\n  }\n\n  getCurrentRestorationData(): RestorationData {\n    return this.getRestorationDataForIdentifier(this.restorationIdentifier)\n  }\n\n  getRestorationDataForIdentifier(identifier: string): RestorationData {\n    if (!(identifier in this.restorationData)) {\n      this.restorationData[identifier] = {}\n    }\n    return this.restorationData[identifier]\n  }\n}\n","import { Controller, VisitOptions } from \"./controller\"\nimport { Locatable } from \"./location\"\n\nconst controller = new Controller\n\nexport default {\n  get supported() {\n    return Controller.supported\n  },\n\n  controller,\n\n  visit(location: Locatable, options?: Partial<VisitOptions>) {\n    controller.visit(location, options)\n  },\n\n  clearCache() {\n    controller.clearCache()\n  },\n\n  setProgressBarDelay(delay: number) {\n    controller.setProgressBarDelay(delay)\n  },\n\n  start() {\n    controller.start()\n  }\n}\n","import { unindent } from \"./util\"\n\n(() => {\n  let element: Element | null = document.currentScript\n  if (!element) return\n  if (element.hasAttribute(\"data-turbolinks-suppress-warning\")) return\n\n  while (element = element.parentElement) {\n    if (element == document.body) {\n      return console.warn(unindent`\n        You are loading Turbolinks from a <script> element inside the <body> element. This is probably not what you meant to do!\n\n        Load your application’s JavaScript bundle inside the <head> element instead. <script> elements in <body> are evaluated with each page change.\n\n        For more information, see: https://github.com/turbolinks/turbolinks#working-with-script-elements\n\n        ——\n        Suppress this warning by adding a \"data-turbolinks-suppress-warning\" attribute to: %s\n      `, element.outerHTML)\n    }\n  }\n})()\n","import namespace from \"./namespace\"\nimport \"./script_warning\"\n\nexport default namespace\n\nif (!window.Turbolinks) {\n  window.Turbolinks = namespace\n  if (!isAMD() && !isCommonJS()) {\n    namespace.start()\n  }\n}\n\ndeclare var define: (() => any) & { amd: any }\n\nfunction isAMD() {\n  return typeof define == \"function\" && define.amd\n}\n\nfunction isCommonJS() {\n  return typeof exports == \"object\" && typeof module != \"undefined\"\n}\n"],"names":["tslib_1.__extends"],"mappings":"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"}